# Cloudflare Workers Configuration
# For deploying backend functions to Cloudflare Workers

name = "mvp-simulation-backend"
main = "backend/dist/index.js"
compatibility_date = "2024-01-01"

# Environment variables
[vars]
ENVIRONMENT = "production"
NODE_ENV = "production"

# Production secrets (use wrangler secret put to set these)
# wrangler secret put GEMINI_API_KEY
# wrangler secret put DATABASE_URL
# wrangler secret put JWT_SECRET

# KV namespaces for caching
[[kv_namespaces]]
binding = "CACHE"
id = "your_kv_namespace_id"

# Durable Objects for state management
[[durable_objects.bindings]]
name = "COUNTER"
class_name = "Counter"

# Scheduled tasks (cron jobs)
[triggers.crons]
# Run health check every hour
"0 * * * *" = "scheduled/health-check.js"

# Route configuration
routes = [
  { pattern = "https://api.mvpsimulation.com/*", zone_name = "mvpsimulation.com" }
]

# Build configuration
[build]
command = "npm run build"

# Site configuration for static assets
[site]
bucket = "./dist"

# Limits and timeouts
[limits]
cpu_ms = 50

# Observability
[observability]
enabled = true
head_sampling_rate = 1